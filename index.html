<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Send Email via Gmail API</title>
    <script src="https://apis.google.com/js/api.js"></script>
</head>
<body>

    <h1>Send Email using Gmail API</h1>

    <!-- Buttons for User Actions -->
    <button id="authorize_button" onclick="handleAuthClick()">Authorize</button>
    <button id="send_email_button" onclick="sendEmail()" style="display:none;">Send Email</button>

    <script type="text/javascript">
        let gapiLoaded = false;

        // Initialize the API client
        function loadClient() {
            gapi.client.setApiKey('AIzaSyC9v00XdQfJan1EdKxDN9QENbTRyi1P0-o'); // Replace with your API key
            return gapi.client.load('https://www.googleapis.com/discovery/v1/apis/gmail/v1/rest');
        }

        // Handle Authorization
        function handleAuthClick() {
            gapi.auth2.getAuthInstance().signIn().then(function() {
                document.getElementById('authorize_button').style.display = 'none';
                document.getElementById('send_email_button').style.display = 'block';
            });
        }

        // Send an email
        function sendEmail() {
            var email = [
                'From: "your-email@gmail.com"\r\n',
                'To: "recipient@example.com"\r\n',
                'Subject: Test Email\r\n\r\n',
                'Hello, this is a test email sent using the Gmail API!'
            ].join('');

            // Base64 encode the email
            var base64EncodedEmail = window.btoa(unescape(encodeURIComponent(email)));

            // Send the email using Gmail API
            var request = gapi.client.gmail.users.messages.send({
                'userId': 'me',
                'resource': {
                    'raw': base64EncodedEmail
                }
            });

            // Execute the request and log the response
            request.execute(function(response) {
                console.log(response);
                alert("Email sent!");
            });
        }

        // Initialize the Google API Client
        function initClient() {
            gapi.auth2.init({
                client_id: '821050995843-8td32c75sus3oiqfol82gnsem0ncdtih.apps.googleusercontent.com', // Replace with your Client ID
                scope: 'https://www.googleapis.com/auth/gmail.send'
            }).then(function() {
                gapiLoaded = true;
                loadClient();
            });
        }

        // Load the API client and authentication library
        gapi.load('client:auth2', initClient);
    </script>
    
</body>
</html>

